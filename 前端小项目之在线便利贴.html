<!doctype html><html class="theme-next mist"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="google-site-verification" content="PBwskePkFkRAnqisXEBN7FyYihV0DkOHyvEC2eDt6Gg"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="baidu-site-verification" content="haLEFmuOYV"><script>!function(e,t,o,c,i,a,n){e.DaoVoiceObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,a=t.createElement(o),n=t.getElementsByTagName(o)[0],a.async=1,a.src=c,a.charset="utf-8",n.parentNode.insertBefore(a,n)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/0f81ff2f.js","daovoice"),daovoice("init",{app_id:"0f81ff2f"}),daovoice("update")</script><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css"><meta name="keywords" content="express"><link rel="alternate" href="/atom.xml" title="Moorez" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.0.2"><meta name="description" content="å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼šç•Œé¢å¯èƒ½ä¸æ˜¯å¤ªå¥½çœ‹ğŸ˜ï¼Œè€ƒè™‘åˆ°å®¹å™¨çš„é«˜åº¦ä¼šè¢«æ‹‰é•¿ï¼Œå› æ­¤æ²¡æœ‰ç”¨å›¾ç‰‡åšèƒŒæ™¯ã€‚é¢„è§ˆä¾¿åˆ©è´´"><meta name="keywords" content="express"><meta property="og:type" content="article"><meta property="og:title" content="å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´"><meta property="og:url" content="http://www.shenzekun.cn/å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´.html"><meta property="og:site_name" content="Moorez"><meta property="og:description" content="å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼šç•Œé¢å¯èƒ½ä¸æ˜¯å¤ªå¥½çœ‹ğŸ˜ï¼Œè€ƒè™‘åˆ°å®¹å™¨çš„é«˜åº¦ä¼šè¢«æ‹‰é•¿ï¼Œå› æ­¤æ²¡æœ‰ç”¨å›¾ç‰‡åšèƒŒæ™¯ã€‚é¢„è§ˆä¾¿åˆ©è´´"><meta property="og:image" content="https://ws3.sinaimg.cn/large/006tKfTcly1fjhulxqhxuj31kw0j976o.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006tKfTcly1fjhuypg0s6j31co0v6439.jpg"><meta property="og:image" content="https://ws3.sinaimg.cn/large/006tKfTcly1fjhv8g9apcj30au0cqq30.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006tKfTcly1fji1acleqhj30ba0k0mxg.jpg"><meta property="og:image" content="https://ws3.sinaimg.cn/large/006tKfTcly1fjhvfxr6p3j319i0qq42h.jpg"><meta property="og:image" content="https://ws2.sinaimg.cn/large/006tKfTcly1fjhvj4lwtgj316a0cgjrb.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006tKfTcly1fji3f1ap39j30ik03cglh.jpg"><meta property="og:image" content="https://ws3.sinaimg.cn/large/006tKfTcly1fji3x6gw2oj30i005q748.jpg"><meta property="og:image" content="https://ws2.sinaimg.cn/large/006tKfTcly1fji3q8xe7tj310i068js2.jpg"><meta property="og:image" content="https://ws4.sinaimg.cn/large/006tKfTcly1fji43t9rgej31b20ug0y0.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006tKfTcly1fji626ceeuj30r40p8t96.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006tKfTcly1fji7u6i1v0j30jm06y0t6.jpg"><meta property="og:updated_time" content="2017-11-12T23:54:48.471Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´"><meta name="twitter:description" content="å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼šç•Œé¢å¯èƒ½ä¸æ˜¯å¤ªå¥½çœ‹ğŸ˜ï¼Œè€ƒè™‘åˆ°å®¹å™¨çš„é«˜åº¦ä¼šè¢«æ‹‰é•¿ï¼Œå› æ­¤æ²¡æœ‰ç”¨å›¾ç‰‡åšèƒŒæ™¯ã€‚é¢„è§ˆä¾¿åˆ©è´´"><meta name="twitter:image" content="https://ws3.sinaimg.cn/large/006tKfTcly1fjhulxqhxuj31kw0j976o.jpg"><script type="text/javascript" id="hexo.configuration">var NexT=window.NexT||{},CONFIG={scheme:"Mist",sidebar:{position:"left",display:"post"},fancybox:!0,motion:!1,duoshuo:{userId:"0",author:"Author"}}</script><link rel="canonical" href="http://www.shenzekun.cn/å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´.html"><title>å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´ | Moorez</title></head><body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans"><div class="container one-collumn sidebar-position-left page-post-detail"><div class="headband"></div><a href="https://github.com/shenzekun" class="github-corner" aria-label="View source on Github"><svg width="92" height="92" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="//schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Moorez</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>é¦–é¡µ</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>åˆ†ç±»</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>å…³äº</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>å½’æ¡£</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>æ ‡ç­¾</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>æœç´¢</a></li></ul><div class="site-search"><div class="popup"><span class="search-icon fa fa-search"></span> <input type="text" id="local-search-input"><div id="local-search-result"></div><span class="popup-btn-close">close</span></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://www.shenzekun.cn/å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="shenzekun"><meta itemprop="description" content=""><meta itemprop="image" content="http://om8u46rmb.bkt.clouddn.com/avatar1.jpg?imageslim"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Moorez"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time itemprop="dateCreated" datetime="2017-09-13T20:48:33+08:00" content="2017-09-13">2017-09-13 </time></span><span class="post-category">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/å‰ç«¯/" itemprop="url" rel="index"><span itemprop="name">å‰ç«¯</span> </a></span></span><span id="/å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´.html" class="leancloud_visitors" data-flag-title="å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">çƒ­åº¦ </span><span class="leancloud-visitors-count"></span> <span>â„ƒ</span></span><div class="post-wordcount"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡</span> <span title="å­—æ•°ç»Ÿè®¡">2,972 å­— </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">é˜…è¯»æ—¶é•¿</span> <span title="é˜…è¯»æ—¶é•¿">14 åˆ†é’Ÿ</span></div></div></header><div class="post-body" itemprop="articleBody"><hr><h2 id="å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š"><a href="#å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š" class="headerlink" title="å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š"></a>å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š</h2><p><img src="https://ws3.sinaimg.cn/large/006tKfTcly1fjhulxqhxuj31kw0j976o.jpg" alt=""></p><p>ç•Œé¢å¯èƒ½ä¸æ˜¯å¤ªå¥½çœ‹ğŸ˜ï¼Œè€ƒè™‘åˆ°å®¹å™¨çš„é«˜åº¦ä¼šè¢«æ‹‰é•¿ï¼Œå› æ­¤æ²¡æœ‰ç”¨å›¾ç‰‡åšèƒŒæ™¯ã€‚</p><h2 id="é¢„è§ˆ"><a href="#é¢„è§ˆ" class="headerlink" title="é¢„è§ˆ"></a>é¢„è§ˆ</h2><p><a href="http://note.shenzekun.cn" target="_blank" rel="external">ä¾¿åˆ©è´´</a></p><a id="more"></a><h2 id="æ¶‰åŠçš„çŸ¥è¯†ç‚¹"><a href="#æ¶‰åŠçš„çŸ¥è¯†ç‚¹" class="headerlink" title="æ¶‰åŠçš„çŸ¥è¯†ç‚¹"></a>æ¶‰åŠçš„çŸ¥è¯†ç‚¹</h2><ul><li><code>sass</code>(css é¢„ç¼–è¯‘å™¨)</li><li><code>webpack</code>ï¼ˆè‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œå®ç°LESS,CSS,JSç¼–è¯‘å’Œå‹ç¼©ä»£ç ï¼‰</li><li><code>express</code> (åŸºäº Node.js å¹³å°çš„ web å¼€å‘æ¡†æ¶)</li><li><code>html+css</code></li><li><code>Node.js</code>(åŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒ)</li><li><code>jQuery</code>(ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´çš„JavaScriptæ¡†æ¶)</li><li><code>sequelize</code>(Nodeçš„ORMæ¡†æ¶Sequelizeæ“ä½œæ•°æ®åº“)</li><li><code>passport</code>(å®ç°ç¬¬ä¸‰æ–¹ç™»å½•)</li></ul><h2 id="å®ç°åŠŸèƒ½"><a href="#å®ç°åŠŸèƒ½" class="headerlink" title="å®ç°åŠŸèƒ½"></a>å®ç°åŠŸèƒ½</h2><ul><li>githubç¬¬ä¸‰æ–¹ç™»å½•</li><li>æ·»åŠ ç¬”è®°ï¼ˆç™»å½•æˆåŠŸåï¼‰</li><li>åˆ é™¤ç¬”è®°</li><li>ä¿®æ”¹ç¬”è®°</li><li>ä½¿ç”¨ markdown(ç±»ä¼¼ typroa)</li><li>ç¬”è®°æ‹–æ‹½</li></ul><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><ul><li><strong>å¿…è¦æ¡ä»¶</strong>ï¼šå·²ç»å®‰è£…å¥½äº†nodeç¯å¢ƒ,è¿˜æ²¡å®‰è£…çš„å¯ä»¥å»<a href="http://nodejs.cn/download/" target="_blank" rel="external">node</a>ä¸­æ–‡å®˜ç½‘ä¸‹è½½</li><li><strong>å°æç¤º</strong>ï¼šå¦‚æœç”¨ npm ä¸‹è½½æ„Ÿè§‰æ…¢çš„è¯ï¼Œå¯ä»¥ä¸‹è½½ä¸€ä¸ªåˆ‡æ¢é•œåƒæºçš„å·¥å…·<code>nrm</code>,åœ¨ç»ˆç«¯è¾“å…¥ï¼š</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm <span class="selector-tag">i</span> nrm -g</div></pre></td></tr></table></figure><p>ç„¶åå¦‚ä¸‹æ“ä½œï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1fjhuypg0s6j31co0v6439.jpg" alt=""></p><p><strong>å¼€å§‹ï¼ï¼</strong></p><p>1.<strong>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåå­—è‡ªå·±èµ·ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œåˆ‡æ¢åˆ°è‡ªå·±æ–°å»ºæ–‡ä»¶å¤¹ï¼Œå¦‚</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> (æ–‡ä»¶å¤¹åç§°)</div></pre></td></tr></table></figure><p>2.<strong>ç”Ÿæˆ <code>package.json</code></strong></p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">npm</span> init -y</div></pre></td></tr></table></figure><p>3.<strong>å®‰è£… express</strong></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm i <span class="built_in">express</span> --<span class="built_in">save</span></div></pre></td></tr></table></figure><p>4.<strong>å®‰è£… <a href="http://www.expressjs.com.cn/starter/generator.html" target="_blank" rel="external">expressç”Ÿæˆå™¨</a>:</strong></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install <span class="built_in">express</span>-generator --<span class="built_in">save</span></div></pre></td></tr></table></figure><p>5.<strong>ç”Ÿæˆ ejs æ¨¡æ¿ï¼ˆç±»ä¼¼ jsp çš„å†™æ³•ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">express <span class="_">-f</span> <span class="_">-e</span></div><div class="line">npm i</div></pre></td></tr></table></figure><p><img src="https://ws3.sinaimg.cn/large/006tKfTcly1fjhv8g9apcj30au0cqq30.jpg" alt=""></p><p>å…¶ä¸­<code>public</code>ç”¨æ¥å­˜æ”¾ç¼–è¯‘åçš„jsæ–‡ä»¶ä»¥åŠç¼–è¯‘å¥½çš„cssæ–‡ä»¶ç­‰ï¼Œ<code>routes</code>ç”¨æ¥å­˜æ”¾å¤„ç† ajax çš„è¯·æ±‚æ–‡ä»¶ï¼Œviewså°±æ˜¯å­˜æ”¾è§†å›¾æ–‡ä»¶<br>ç„¶åæ–°å»º database å’Œ srcï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1fji1acleqhj30ba0k0mxg.jpg" alt=""></p><p>å…¶ä¸­ src/js é‡Œé¢ app ä»£è¡¨ä¸åŒé¡µé¢çš„å…¥å£æ–‡ä»¶ï¼Œlib å°±æ˜¯ä¸€äº›å¸¸ç”¨çš„åº“ï¼Œmod å°±æ˜¯ä½ å†™çš„ä¸€äº›æ¨¡å—ï¼Œdatabase ç”¨æ¥å­˜æ”¾æ•°æ®åº“æ•°æ®çš„</p><p>6.<strong>è¾“å…¥ï¼š</strong></p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">npm</span> start</div></pre></td></tr></table></figure><p>å¦‚æœæœ‰å‡ºç°ä¸‹é¢çš„é”™è¯¯ï¼š</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcly1fjhvfxr6p3j319i0qq42h.jpg" alt=""></p><p>å‡ºç°è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸ºä½ æ²¡æœ‰ä¸‹è½½æ¨¡å—ï¼Œåªéœ€åœ¨ç»ˆç«¯è¾“å…¥ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm <span class="selector-tag">i</span> (æ¨¡å—å) --save</div></pre></td></tr></table></figure><p>å°±å¯ä»¥äº†</p><p>7.<strong>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥<code>localhost:3000</code></strong><br>å‡ºç°ä¸‹é¢è¿™æ ·å°±è¯´æ˜æˆåŠŸäº†ï¼š</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcly1fjhvj4lwtgj316a0cgjrb.jpg" alt=""></p><p>8.<strong>æ¥ä¸‹æ¥å®‰è£…webpackå’Œç›¸å…³ä¾èµ–</strong></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm i webpack --<span class="built_in">save</span>-dev</div><div class="line">npm i --<span class="built_in">save</span> css-loader <span class="built_in">style</span>-loader <span class="built_in">express</span>-session <span class="built_in">express</span>-flash node-sass passport sass sass-loader sequelize sqlite3 extract-text-webpack-plugin onchange</div></pre></td></tr></table></figure><p>9.<strong>åœ¨ src é‡Œå»ºä¸€ä¸ª webpack.config.jsï¼Œé…ç½®å¦‚ä¸‹</strong>ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"><span class="keyword">var</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>)</div><div class="line"><span class="keyword">var</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>);</div><div class="line">    </div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    entry: path.join(__dirname, <span class="string">"js/app/index"</span>),</div><div class="line">    output: &#123;</div><div class="line">        path: path.join(__dirname, <span class="string">"../public"</span>),</div><div class="line">        filename: <span class="string">"js/index.js"</span></div><div class="line">    &#125;,</div><div class="line">    <span class="keyword">module</span>: &#123;</div><div class="line">        rules: [&#123;</div><div class="line">            test: <span class="regexp">/(\.scss)$/</span>,</div><div class="line">            use: ExtractTextPlugin.extract(&#123;</div><div class="line">                fallback: <span class="string">"style-loader"</span>,</div><div class="line">                use: [<span class="string">"css-loader"</span>, <span class="string">"sass-loader"</span>]</div><div class="line">            &#125;) <span class="comment">//æŠŠ css æŠ½ç¦»å‡ºæ¥ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶</span></div><div class="line">        &#125;]</div><div class="line">    &#125;,</div><div class="line">    resolve: &#123;</div><div class="line">        alias: &#123;</div><div class="line">            jquery: path.join(__dirname, <span class="string">"js/lib/jquery-2.0.3.min.js"</span>),</div><div class="line">            mod: path.join(__dirname, <span class="string">"js/mod"</span>),</div><div class="line">            sass: path.join(__dirname, <span class="string">"sass"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    plugins: [</div><div class="line">        <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</div><div class="line">            $: <span class="string">"jquery"</span></div><div class="line">        &#125;),</div><div class="line">        <span class="keyword">new</span> ExtractTextPlugin(<span class="string">"css/index.css"</span>),</div><div class="line">        <span class="keyword">new</span> webpack.LoaderOptionsPlugin(&#123;</div><div class="line">            options: &#123;</div><div class="line">                css: [</div><div class="line">                    autoprefixer(),</div><div class="line">                ]</div><div class="line">            &#125;</div><div class="line">        &#125;),</div><div class="line">        <span class="keyword">new</span> webpack.optimize.UglifyJsPlugin(&#123;</div><div class="line">            compress: &#123;</div><div class="line">                warnings: <span class="literal">false</span></div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¯´æ˜</p><ul><li>entry:å…¥å£æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ src/js/appé‡Œé¢çš„index.js,å…¶ä¸­__dirnameæ˜¯è·å¾—å½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•çš„å®Œæ•´ç›®å½•å</li><li>output:è¾“å‡ºç¼–è¯‘åçš„æ–‡ä»¶ index.jsï¼Œè¾“å‡ºåˆ° public/js é‡Œé¢</li><li>moduleï¼šé…ç½®Loadersï¼Œé€šè¿‡ä½¿ç”¨ä¸åŒçš„loaderï¼Œwebpackæœ‰èƒ½åŠ›è°ƒç”¨å¤–éƒ¨çš„è„šæœ¬æˆ–å·¥å…·ï¼Œå®ç°å¯¹ä¸åŒæ ¼å¼çš„æ–‡ä»¶çš„å¤„ç†ï¼Œæ¯”å¦‚è¯´åˆ†æè½¬æ¢scssä¸ºcssï¼Œæˆ–è€…æŠŠä¸‹ä¸€ä»£çš„JSæ–‡ä»¶</li><li>resolve.aliasï¼šè®¾ç½®æ¨¡å—åˆ«åï¼Œä¾¿äºæˆ‘ä»¬æ›´æ–¹ä¾¿å¼•ç”¨ï¼Œæ¯”å¦‚è¯´æˆ‘åœ¨ jsé‡Œé¢çš„æ–‡ä»¶éœ€è¦ jqueryï¼Œåœ¨é‡Œé¢çš„æ–‡ä»¶ç›´æ¥å†™ require(â€œjqueryâ€) å°±è¡Œäº†</li><li><p>å¦‚æœæ‰€æœ‰æ–‡ä»¶éƒ½éœ€è¦ jquery,é‚£ä¹ˆç›´æ¥åœ¨ pluginsé‡Œé¢å†™æˆè¿™æ ·ï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1fji3f1ap39j30ik03cglh.jpg" alt=""></p><p>å°±ä¸éœ€è¦ require äº†</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcly1fji3x6gw2oj30i005q748.jpg" alt=""><br>è¿™ä¸ªæ˜¯å‹ç¼©æ–‡ä»¶çš„</p></li></ul><p>10.<strong>åœ¨ package.json ä¸­ï¼Œå¢åŠ å¦‚ä¸‹ä¸¤æ¡ï¼š</strong><br><img src="https://ws2.sinaimg.cn/large/006tKfTcly1fji3q8xe7tj310i068js2.jpg" alt=""></p><p>å†™æˆè¿™æ ·ï¼Œä½ åœ¨ç»ˆç«¯å°±å¯ä»¥å†™æˆ<code>npm run webpack</code> æ¥ç¼–è¯‘æ–‡ä»¶ï¼Œ<br><code>npm run watch</code>æ¥ç›‘æ§ src é‡Œé¢çš„ js å’Œ scss çš„å˜åŒ–ï¼Œåªè¦ä¸€ä¿®æ”¹ï¼Œè¿›è¡Œç¼–è¯‘ï¼Œæé«˜äº†æ•ˆç‡</p><p>11.<strong>æµ‹è¯•</strong></p><p>ä½ å¯ä»¥è¯•è¯•åœ¨ js é‡Œé¢çš„ index.jså†™ç‚¹ä¸œè¥¿ï¼Œç„¶å npm run webpackï¼Œå¦‚æœç»ˆç«¯æ˜¾ç¤ºæ˜¯è¿™æ ·ï¼š</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcly1fji43t9rgej31b20ug0y0.jpg" alt=""></p><p>å°±è¯æ˜æˆåŠŸäº†</p><h2 id="é¡¹ç›®æ€è·¯"><a href="#é¡¹ç›®æ€è·¯" class="headerlink" title="é¡¹ç›®æ€è·¯"></a>é¡¹ç›®æ€è·¯</h2><p>é€»è¾‘æ¯”è¾ƒç®€å•</p><ol><li>é¦–å…ˆç”¨æˆ·å¿…é¡»ç™»å½•æ‰èƒ½æ·»åŠ ç¬”è®°ï¼Œå½“ç”¨æˆ·å¤±ç„¦çš„æ—¶å€™ï¼Œå°†æ•°æ®æ’å…¥æ•°æ®åº“ï¼Œå¹¶ä¸”é‡æ–°å¸ƒå±€ï¼ˆç€‘å¸ƒæµï¼‰</li><li>ç”¨æˆ·ä¸èƒ½æ›´æ”¹å…¶ä»–ç”¨æˆ·çš„ç¬”è®°ï¼Œé™¤äº†ç®¡ç†å‘˜ğŸ˜„</li><li>ç”¨æˆ·æ›´æ–°ç¬”è®°ä¹‹åï¼Œæ•°æ®åº“çš„æ•°æ®é‡æ–°æ›´æ–°ï¼Œé‡æ–°å¸ƒå±€</li><li>ç”¨æˆ·å¯ä»¥åˆ é™¤ç¬”è®°ï¼Œæ•°æ®ä»æ•°æ®åº“ä¸­åˆ é™¤ï¼Œé‡æ–°å¸ƒå±€</li><li>ç”¨æˆ·å¯ä»¥æ‹–æ‹½ç¬”è®°ï¼Œä½†ä¸å°†ä½ç½®å­˜å…¥æ•°æ®åº“</li></ol><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>html,csså°±ä¸è®²äº†ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘çš„<a href="https://github.com/shenzekun/sticky-note" target="_blank" rel="external">æºç </a>,ä¸»è¦è®² jsã€‚</p><p>1.<strong>ç€‘å¸ƒæµçš„å®ç°</strong></p><p>æ€è·¯ï¼šï¼ˆå‰ææ˜¯å¿…é¡»ç»å¯¹å®šä½ï¼‰</p><blockquote><ol><li>è·å–å…ƒç´ çš„å®½åº¦</li><li>é€šè¿‡çª—å£çš„å®½åº¦é™¤ä»¥å…ƒç´ çš„å®½åº¦æ¥è·å–åˆ—æ•°</li><li>åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„æ¥è·å–æ¯åˆ—çš„é«˜åº¦ï¼Œåˆå§‹åŒ–æ¯åˆ—çš„é«˜åº¦ä¸º0</li><li>éå†å…ƒç´ ï¼Œè·å–æœ€å°çš„çš„åˆ—æ•°çš„é«˜åº¦å’Œç´¢å¼•ï¼Œå¯¹å½“å‰å…ƒç´ è¿›è¡Œå®šä½ï¼Œåˆ—æ•°é«˜åº¦åŠ ç­‰äºå½“å‰å…ƒç´ çš„é«˜åº¦</li></ol></blockquote><p>çŸ¥é“æ€è·¯åï¼Œä»£ç å¾ˆå¿«å°±å†™å‡ºæ¥äº†ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> WaterFall = (<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">var</span> $ct, $items;</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">render</span><span class="params">($c)</span> </span>&#123;</div><div class="line">            $ct = $c;</div><div class="line">            $items = $ct.children();</div><div class="line">            <span class="keyword">var</span> nodeWidth = $items.outerWidth(<span class="keyword">true</span>),</div><div class="line">                windowHeight = $(window).height(),</div><div class="line">                colNum = parseInt($(window).width() / nodeWidth), <span class="comment">//è·å–åˆ—æ•°</span></div><div class="line">                colSumHeight = []; <span class="comment">//è·å–æ¯åˆ—çš„é«˜åº¦</span></div><div class="line">            <span class="comment">//å¯¹æ¯åˆ—çš„é«˜åº¦è¿›è¡Œåˆå§‹åŒ–</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; colNum; i++) &#123;</div><div class="line">                colSumHeight[i] = <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">            $items.each(<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">                <span class="keyword">var</span> $current = $(this);</div><div class="line">                <span class="keyword">var</span> index = <span class="number">0</span>,</div><div class="line">                    minSumHeight = colSumHeight[<span class="number">0</span>];</div><div class="line">                <span class="comment">//è·å–æœ€å°çš„çš„åˆ—æ•°çš„é«˜åº¦å’Œç´¢å¼•</span></div><div class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; colSumHeight.length; i++) &#123;</div><div class="line">                    <span class="keyword">if</span> (minSumHeight &gt; colSumHeight[i]) &#123;</div><div class="line">                        index = i;</div><div class="line">                        minSumHeight = colSumHeight[i];</div><div class="line">                    &#125;</div><div class="line">                &#125;            </div><div class="line">                <span class="comment">//æ”¹å˜çª—å£é«˜åº¦</span></div><div class="line">                <span class="keyword">if</span> (windowHeight &lt; minSumHeight) &#123;</div><div class="line">                    $(<span class="string">"body"</span>).height(minSumHeight);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    $(<span class="string">"body"</span>).height(windowHeight - <span class="number">72</span>);</div><div class="line">                &#125;</div><div class="line">                <span class="comment">//å¯¹å½“å‰å…ƒç´ è¿›è¡Œå®šä½</span></div><div class="line">                $current.animate(&#123;</div><div class="line">                    left: nodeWidth * index,</div><div class="line">                    top: minSumHeight</div><div class="line">                &#125;, <span class="number">5</span>);</div><div class="line">                colSumHeight[index] += $current.outerHeight(<span class="keyword">true</span>);</div><div class="line">    </div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//å½“çª—å£å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°æ¸²æŸ“</span></div><div class="line">        $(window).on(<span class="string">'resize'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">            render($ct);</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">return</span> &#123;</div><div class="line">            init: render</div><div class="line">        &#125;</div><div class="line">    &#125;)();</div></pre></td></tr></table></figure><p>2.<strong>ç¬”è®°çš„æ‹–æ‹½</strong></p><p>æˆ‘ä»¬å…ˆçœ‹ä¸ªå›¾</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1fji626ceeuj30r40p8t96.jpg" alt=""></p><p>å› æ­¤ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®ç¬”è®°çš„ç§»åŠ¨</span></div><div class="line">      $noteHead.on(<span class="string">'mousedown'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">          <span class="keyword">var</span> evtX = e.pageX - $note.offset().left, <span class="comment">//evtX è®¡ç®—äº‹ä»¶çš„è§¦å‘ç‚¹åœ¨ dialogå†…éƒ¨åˆ° dialog çš„å·¦è¾¹ç¼˜çš„è·ç¦»</span></div><div class="line">              evtY = e.pageY - $note.offset().top;</div><div class="line">          $note.addClass(<span class="string">'draggable'</span>).data(<span class="string">'evtPos'</span>, &#123;</div><div class="line">              <span class="attr">x</span>: evtX,</div><div class="line">              <span class="attr">y</span>: evtY</div><div class="line">          &#125;); <span class="comment">//æŠŠäº‹ä»¶åˆ° dialog è¾¹ç¼˜çš„è·ç¦»ä¿å­˜ä¸‹æ¥</span></div><div class="line">      &#125;).on(<span class="string">'mouseup'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">          $note.removeClass(<span class="string">'draggable'</span>).removeData(<span class="string">'pos'</span>);</div><div class="line">      &#125;);</div><div class="line">    </div><div class="line">      $(<span class="string">'body'</span>).on(<span class="string">'mousemove'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">          $(<span class="string">'.draggable'</span>).length &amp;&amp; $(<span class="string">'.draggable'</span>).offset(&#123;</div><div class="line">              <span class="attr">top</span>: e.pageY - $(<span class="string">'.draggable'</span>).data(<span class="string">'evtPos'</span>).y, <span class="comment">// å½“ç”¨æˆ·é¼ æ ‡ç§»åŠ¨æ—¶ï¼Œæ ¹æ®é¼ æ ‡çš„ä½ç½®å’Œå‰é¢ä¿å­˜çš„è·ç¦»ï¼Œè®¡ç®— dialog çš„ç»å¯¹ä½ç½®</span></div><div class="line">              left: e.pageX - $(<span class="string">'.draggable'</span>).data(<span class="string">'evtPos'</span>).x</div><div class="line">          &#125;);</div><div class="line">      &#125;);</div><div class="line">  &#125;,</div></pre></td></tr></table></figure><p>3.<strong>æç¤ºæ¨¡å—</strong></p><p>è¿™ä¸ªæ¯”è¾ƒå®¹æ˜“ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* </span></div><div class="line">æç¤ºæ¨¡å—</div><div class="line">å‚æ•°ï¼šçŠ¶æ€(1è¡¨ç¤ºæˆåŠŸï¼Œ0è¡¨ç¤ºå¤±è´¥)ï¼Œæ¶ˆæ¯ï¼Œå‡ºç°æ—¶é—´(ä¸å†™é»˜è®¤æ˜¯1s)</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">toast</span>(<span class="params">status, msg, time</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.status = status;</div><div class="line">    <span class="keyword">this</span>.msg = msg;</div><div class="line">    <span class="keyword">this</span>.time = time || <span class="number">1000</span>;</div><div class="line">    <span class="keyword">this</span>.createToast();</div><div class="line">    <span class="keyword">this</span>.showToast();</div><div class="line">&#125;</div><div class="line"></div><div class="line">toast.prototype = &#123;</div><div class="line">    <span class="attr">createToast</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.status === <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">var</span> html = <span class="string">'&lt;div class="toast"&gt;&lt;img src="../../imgs/1.png" class="toast_icon"&gt;&lt;/img&gt;&lt;span class="toast_word"&gt;'</span> + <span class="keyword">this</span>.msg + <span class="string">'&lt;/span&gt;&lt;/div&gt;'</span>;</div><div class="line">            <span class="keyword">this</span>.$toast = $(html);</div><div class="line">            $(<span class="string">'body'</span>).append(<span class="keyword">this</span>.$toast);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">var</span> html = <span class="string">'&lt;div class="toast"&gt;&lt;img src="../../imgs/0.png" class="toast_icon"&gt;&lt;/img&gt;&lt;span class="toast_word"&gt;'</span> + <span class="keyword">this</span>.msg + <span class="string">'&lt;/span&gt;&lt;/div&gt;'</span>;</div><div class="line">            <span class="keyword">this</span>.$toast = $(html);</div><div class="line">            $(<span class="string">'body'</span>).append(<span class="keyword">this</span>.$toast);</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">showToast</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> _this = <span class="keyword">this</span>;</div><div class="line">        <span class="keyword">this</span>.$toast.fadeIn(<span class="number">300</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                _this.$toast.fadeOut(<span class="number">300</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                    _this.$toast.remove();</div><div class="line">                &#125;);</div><div class="line">            &#125;, _this.time);</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Toast</span>(<span class="params">status, msg, time</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> toast(status, msg, time);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>4.<strong>ç¬”è®°æ¨¡å—</strong></p><p>æ€è·¯ï¼š</p><blockquote><ol><li>åˆå§‹åŒ–ï¼ˆå¦‚ idï¼Œusername ç­‰ç­‰ï¼‰</li><li>åˆ›å»ºèŠ‚ç‚¹</li><li>è®¾ç½®é¢œè‰²</li><li>ç»‘å®šäº‹ä»¶</li></ol></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Note</span>(<span class="params">opts</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.initOpts(opts);</div><div class="line">    <span class="keyword">this</span>.createNode();</div><div class="line">    <span class="keyword">this</span>.setColor();</div><div class="line">    <span class="keyword">this</span>.bind();</div><div class="line">&#125;</div><div class="line"></div><div class="line">Note.prototype = &#123;</div><div class="line">    <span class="attr">colors</span>: [</div><div class="line">        [<span class="string">'#ea9b35'</span>, <span class="string">'#efb04e'</span>], <span class="comment">// headColor, containerColor</span></div><div class="line">        [<span class="string">'#dd598b'</span>, <span class="string">'#e672a2'</span>],</div><div class="line">        [<span class="string">'#c24226'</span>, <span class="string">'#d15a39'</span>],</div><div class="line">        [<span class="string">'#c1c341'</span>, <span class="string">'#d0d25c'</span>],</div><div class="line">        [<span class="string">'#3f78c3'</span>, <span class="string">'#5591d2'</span>]</div><div class="line">    ],</div><div class="line">    <span class="attr">defaultOpts</span>: &#123;</div><div class="line">        <span class="attr">id</span>: <span class="string">''</span>, <span class="comment">//Noteçš„ id</span></div><div class="line">        $ct: $(<span class="string">'#content'</span>).length &gt; <span class="number">0</span> ? $(<span class="string">'#content'</span>) : $(<span class="string">'body'</span>), <span class="comment">//é»˜è®¤å­˜æ”¾ Note çš„å®¹å™¨</span></div><div class="line">        context: <span class="string">'è¯·è¾“å…¥å†…å®¹'</span>, <span class="comment">//Note çš„å†…å®¹</span></div><div class="line">        createTime: <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleDateString().replace(<span class="regexp">/\//g</span>, <span class="string">'-'</span>).match(<span class="regexp">/^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;/</span>),</div><div class="line">        <span class="attr">username</span>: <span class="string">'admin'</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">initOpts</span>: <span class="function"><span class="keyword">function</span> (<span class="params">opts</span>) </span>&#123;</div><div class="line">        <span class="keyword">this</span>.opts = $.extend(&#123;&#125;, <span class="keyword">this</span>.defaultOpts, opts || &#123;&#125;);</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.opts.id) &#123;</div><div class="line">            <span class="keyword">this</span>.id = <span class="keyword">this</span>.opts.id;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.createTime = <span class="keyword">this</span>.opts.createTime ? <span class="keyword">this</span>.opts.createTime : <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleDateString().replace(<span class="regexp">/\//g</span>, <span class="string">'-'</span>).match(<span class="regexp">/^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;/</span>);</div><div class="line">        <span class="keyword">this</span>.username = <span class="keyword">this</span>.opts.username ? <span class="keyword">this</span>.opts.username : <span class="string">'admin'</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">createNode</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> tpl = <span class="string">'&lt;div class="note"&gt;'</span> +</div><div class="line">            <span class="string">'&lt;div class="note-head"&gt;&lt;span class="delete"&gt;&amp;times;&lt;/span&gt;&lt;/div&gt;'</span> +</div><div class="line">            <span class="string">'&lt;div class="note-ct" contenteditable="true"&gt;&lt;/div&gt;'</span> +</div><div class="line">            <span class="string">'&lt;div class="note-info"&gt;&lt;div class="note-name"&gt;'</span> + <span class="keyword">this</span>.username + <span class="string">'&lt;/div&gt;&lt;div class="note-time"&gt;'</span> + <span class="keyword">this</span>.createTime + <span class="string">'&lt;/div&gt;'</span> +</div><div class="line">            <span class="string">'&lt;/div&gt;'</span>;</div><div class="line">        <span class="keyword">this</span>.$note = $(tpl);</div><div class="line">        <span class="keyword">this</span>.$note.find(<span class="string">'.note-ct'</span>).html(<span class="keyword">this</span>.opts.context);</div><div class="line">        <span class="keyword">this</span>.opts.$ct.append(<span class="keyword">this</span>.$note);</div><div class="line">        <span class="comment">//if (!this.id) this.$note.css('bottom', '10px'); //æ–°å¢æ”¾åˆ°å³è¾¹</span></div><div class="line">        Event.fire(<span class="string">'waterfall'</span>);</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    <span class="attr">setColor</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> color = <span class="keyword">this</span>.colors[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">5</span>)];</div><div class="line">        <span class="keyword">this</span>.$note.find(<span class="string">".note-head"</span>).css(<span class="string">'background-color'</span>, color[<span class="number">0</span>]);</div><div class="line">        <span class="keyword">this</span>.$note.find(<span class="string">'.note-ct'</span>).css(<span class="string">'background-color'</span>, color[<span class="number">1</span>]);</div><div class="line">        <span class="keyword">this</span>.$note.find(<span class="string">'.note-info'</span>).css(<span class="string">'background-color'</span>, color[<span class="number">1</span>]);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">setLayout</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">        <span class="keyword">if</span> (self.clock) &#123;</div><div class="line">            clearTimeout(self.clock);</div><div class="line">        &#125;</div><div class="line">        self.clock = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            Event.fire(<span class="string">'waterfall'</span>);</div><div class="line">        &#125;, <span class="number">100</span>);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">bind</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> _this = <span class="keyword">this</span>, <span class="comment">//è®°å½•ä¸‹å‘ï¼Œä¹‹å‰æœ«å°¾æ˜¯åˆ†å·ä¸æ˜¯é€—å·åé¢éƒ½å˜æˆäº†å…¨å±€å˜é‡ç»“æœé€ æˆäº†æœ€åä¸€ä¸ªæ‰èƒ½ä¿®æ”¹ğŸ˜‚</span></div><div class="line">            $note = <span class="keyword">this</span>.$note,</div><div class="line">            $noteHead = $note.find(<span class="string">'.note-head'</span>),</div><div class="line">            $noteCt = $note.find(<span class="string">'.note-ct'</span>),</div><div class="line">            $close = $note.find(<span class="string">'.delete'</span>);</div><div class="line"></div><div class="line">        $close.on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            _this.delete();</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        $noteCt.on(<span class="string">'focus'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> ($noteCt.html() === <span class="string">'è¯·è¾“å…¥å†…å®¹'</span>) $noteCt.html(<span class="string">''</span>);</div><div class="line">            $noteCt.data(<span class="string">'before'</span>, $noteCt.html());</div><div class="line">        &#125;).on(<span class="string">'blur paste'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> ($noteCt.data(<span class="string">'before'</span>) != $noteCt.html()) &#123;</div><div class="line">                $noteCt.data(<span class="string">'before'</span>, $noteCt.html());</div><div class="line">                _this.setLayout();</div><div class="line">                <span class="keyword">if</span> (_this.id) &#123; <span class="comment">//åˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ªidï¼Œå¦‚æœæœ‰å°±æ›´æ–°ï¼Œå¦‚æœæ²¡æœ‰å°±æ·»åŠ </span></div><div class="line">                    _this.edit($noteCt.html())</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    _this.add($noteCt.html())</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        <span class="comment">//è®¾ç½®ç¬”è®°çš„ç§»åŠ¨</span></div><div class="line">        $noteHead.on(<span class="string">'mousedown'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> evtX = e.pageX - $note.offset().left, <span class="comment">//evtX è®¡ç®—äº‹ä»¶çš„è§¦å‘ç‚¹åœ¨ dialogå†…éƒ¨åˆ° dialog çš„å·¦è¾¹ç¼˜çš„è·ç¦»</span></div><div class="line">                evtY = e.pageY - $note.offset().top;</div><div class="line">            $note.addClass(<span class="string">'draggable'</span>).data(<span class="string">'evtPos'</span>, &#123;</div><div class="line">                <span class="attr">x</span>: evtX,</div><div class="line">                <span class="attr">y</span>: evtY</div><div class="line">            &#125;); <span class="comment">//æŠŠäº‹ä»¶åˆ° dialog è¾¹ç¼˜çš„è·ç¦»ä¿å­˜ä¸‹æ¥</span></div><div class="line">        &#125;).on(<span class="string">'mouseup'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            $note.removeClass(<span class="string">'draggable'</span>).removeData(<span class="string">'pos'</span>);</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        $(<span class="string">'body'</span>).on(<span class="string">'mousemove'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">            $(<span class="string">'.draggable'</span>).length &amp;&amp; $(<span class="string">'.draggable'</span>).offset(&#123;</div><div class="line">                <span class="attr">top</span>: e.pageY - $(<span class="string">'.draggable'</span>).data(<span class="string">'evtPos'</span>).y, <span class="comment">// å½“ç”¨æˆ·é¼ æ ‡ç§»åŠ¨æ—¶ï¼Œæ ¹æ®é¼ æ ‡çš„ä½ç½®å’Œå‰é¢ä¿å­˜çš„è·ç¦»ï¼Œè®¡ç®— dialog çš„ç»å¯¹ä½ç½®</span></div><div class="line">                left: e.pageX - $(<span class="string">'.draggable'</span>).data(<span class="string">'evtPos'</span>).x</div><div class="line">            &#125;);</div><div class="line">        &#125;);</div><div class="line">    &#125;,</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/* æ·»åŠ ç¬”è®°åˆ°æ•°æ®åº“ */</span></div><div class="line">    add: <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> _this = <span class="keyword">this</span>;</div><div class="line">        $.post(<span class="string">'/api/notes/add'</span>, &#123;</div><div class="line">            <span class="attr">note</span>: msg</div><div class="line">        &#125;).done(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (res.status === <span class="number">1</span>) &#123;</div><div class="line">                _this.id = res.id;</div><div class="line">                Toast(<span class="number">1</span>, <span class="string">'æ·»åŠ æˆåŠŸï¼'</span>);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                _this.$note.remove();</div><div class="line">                Event.fire(<span class="string">'waterfall'</span>);</div><div class="line">                Toast(<span class="number">0</span>, res.errorMsg);</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">/* ç¼–è¾‘ç¬”è®°æ•°æ®åº“ */</span></div><div class="line">    edit: <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> _this = <span class="keyword">this</span>;</div><div class="line">        $.post(<span class="string">'/api/notes/edit'</span>, &#123;</div><div class="line">            <span class="attr">id</span>: <span class="keyword">this</span>.id,</div><div class="line">            <span class="attr">note</span>: msg</div><div class="line">        &#125;).done(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (res.status === <span class="number">1</span>) &#123;</div><div class="line">                Toast(<span class="number">1</span>, <span class="string">'æ›´æ–°æˆåŠŸï¼'</span>);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                Toast(<span class="number">0</span>, res.errorMsg);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">/* åˆ é™¤ç¬”è®° */</span></div><div class="line">    <span class="keyword">delete</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> _this = <span class="keyword">this</span>;</div><div class="line">        <span class="keyword">if</span> (confirm(<span class="string">"ç¡®è®¤è¦åˆ é™¤å—ï¼Ÿ"</span>)) &#123;</div><div class="line">            $.post(<span class="string">'/api/notes/delete'</span>, &#123;</div><div class="line">                <span class="attr">id</span>: <span class="keyword">this</span>.id</div><div class="line">            &#125;).done(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</div><div class="line">                <span class="keyword">if</span> (res.status === <span class="number">1</span>) &#123;</div><div class="line">                    Toast(<span class="number">1</span>, <span class="string">'åˆ é™¤æˆåŠŸï¼'</span>);</div><div class="line">                    _this.$note.remove();</div><div class="line">                    Event.fire(<span class="string">'waterfall'</span>)</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    Toast(<span class="number">0</span>, res.errorMsg);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>5.<strong>ç¬”è®°ç®¡ç†æ¨¡å—</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> NoteManager = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//é¡µé¢åŠ è½½</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">load</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        $.get(<span class="string">'api/notes'</span>).done(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (res.status === <span class="number">1</span>) &#123;</div><div class="line">                $.each(res.data, <span class="function"><span class="keyword">function</span> (<span class="params">index, msg</span>) </span>&#123;</div><div class="line">                    <span class="keyword">new</span> Note(&#123;</div><div class="line">                        <span class="attr">id</span>: msg.id,</div><div class="line">                        <span class="attr">context</span>: msg.text,</div><div class="line">                        <span class="attr">createTime</span>: msg.createdAt.match(<span class="regexp">/^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;/</span>),</div><div class="line">                        <span class="attr">username</span>: msg.username</div><div class="line">                    &#125;);</div><div class="line">                &#125;);</div><div class="line"></div><div class="line">                Event.fire(<span class="string">'waterfall'</span>);</div><div class="line"></div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                Toast(<span class="number">0</span>, res.errorMsg);</div><div class="line">            &#125;</div><div class="line">        &#125;).fail(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            Toast(<span class="number">0</span>, <span class="string">"ç½‘ç»œå¼‚å¸¸"</span>);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/* æ·»åŠ ç¬”è®° */</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        $.get(<span class="string">'/login'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;<span class="comment">//åˆ¤æ–­æ˜¯å¦ç™»å½•</span></div><div class="line">            <span class="keyword">if</span> (res.status === <span class="number">1</span>) &#123;</div><div class="line">                <span class="keyword">new</span> Note(&#123;</div><div class="line">                    <span class="attr">username</span>: res.username</div><div class="line">                &#125;);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                Toast(<span class="number">0</span>, res.errorMsg);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">load</span>: load,</div><div class="line">        <span class="attr">add</span>: add</div><div class="line">    &#125;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure><p>6.<strong>å‘å¸ƒè®¢é˜…æ¨¡å¼</strong></p><figure class="highlight qml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* å‘å¸ƒè®¢é˜…æ¨¡å¼ */</span></div><div class="line"><span class="built_in">var</span> Event = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">var</span> events = &#123;&#125;;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">on</span>(<span class="params">evt, handler</span>) </span>&#123;</div><div class="line">        events[evt] = events[evt] || [];</div><div class="line">        events[evt].push(&#123;</div><div class="line">            <span class="attribute">handler</span>: handler</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fire</span>(<span class="params">evt, args</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!events[evt]) &#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="built_in">var</span> i = <span class="number">0</span>; i &lt; events[evt].length; i++) &#123;</div><div class="line">            events[evt][i].handler(args);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">off</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">        <span class="keyword">delete</span> events[name];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attribute">on</span>: <span class="keyword">on</span>,</div><div class="line">        <span class="attribute">fire</span>: fire,</div><div class="line">        <span class="attribute">off</span>: off</div><div class="line">    &#125;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure><p>å†™å®Œæ¨¡å—åï¼Œå†™å…¥å£æ–‡ä»¶index.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>(<span class="string">'sass/index.scss'</span>);</div><div class="line"><span class="keyword">var</span> Toast = <span class="built_in">require</span>(<span class="string">'mod/toast.js'</span>).Toast;</div><div class="line"><span class="keyword">var</span> WaterFall = <span class="built_in">require</span>(<span class="string">'mod/waterfall.js'</span>);</div><div class="line"><span class="keyword">var</span> NoteManager = <span class="built_in">require</span>(<span class="string">'mod/note-manager'</span>);</div><div class="line"><span class="keyword">var</span> Event = <span class="built_in">require</span>(<span class="string">'mod/event.js'</span>);</div><div class="line"></div><div class="line"></div><div class="line">NoteManager.load();</div><div class="line">$(<span class="string">'.add-note'</span>).on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    NoteManager.add();</div><div class="line">&#125;)</div><div class="line"></div><div class="line">Event.on(<span class="string">'waterfall'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    WaterFall.init($(<span class="string">"#content"</span>));</div><div class="line">&#125;)</div></pre></td></tr></table></figure><p>åˆ°è¿™å°±å·®ä¸å¤šå®Œæˆäº†70%äº†ï¼Œæ¥ä¸‹æ¥å°±åˆ›å»ºæ•°æ®åº“ï¼Œè¿æ¥æ•°æ®åº“äº†</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">/*åˆ›å»ºæ•°æ®åº“ è¿è¡Œ node note.js*/</div><div class="line"></div><div class="line">var Sequelize = <span class="built_in">require</span>(<span class="string">'sequelize'</span>);</div><div class="line">var path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line">var sequelize = new Sequelize(undefined, undefined, undefined, &#123;</div><div class="line">    host: <span class="string">'localhost'</span>,</div><div class="line">    dialect: <span class="string">'sqlite'</span>,</div><div class="line">    // SQLite only</div><div class="line">    storage: path.join(__dirname, <span class="string">'../database/database.sqlite'</span>)</div><div class="line">&#125;);</div><div class="line"></div><div class="line">/* æµ‹è¯•è¿æ¥æ˜¯å¦æˆåŠŸ</div><div class="line">node note.js</div><div class="line"></div><div class="line">sequelize.authenticate()</div><div class="line">    .<span class="keyword">then</span>(() =&gt; &#123;</div><div class="line">        console.log(<span class="string">'Connection has been established successfully.'</span>);</div><div class="line">    &#125;)</div><div class="line">    .catch(err =&gt; &#123;</div><div class="line">        console.<span class="built_in">error</span>(<span class="string">'Unable to connect to the database:'</span>, err);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">*/</div><div class="line"></div><div class="line"></div><div class="line">var Note = sequelize.define(<span class="string">'note'</span>, &#123;</div><div class="line">    text: &#123;</div><div class="line">        <span class="built_in">type</span>: Sequelize.STRING</div><div class="line">    &#125;,</div><div class="line">    userid: &#123;</div><div class="line">        <span class="built_in">type</span>: Sequelize.INTEGER</div><div class="line">    &#125;,</div><div class="line">    username: &#123;</div><div class="line">        <span class="built_in">type</span>: Sequelize.STRING</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">Note.sync();</div><div class="line"></div><div class="line">/*</div><div class="line">åˆ é™¤è¡¨</div><div class="line">Note.drop();</div><div class="line">*/</div><div class="line"></div><div class="line"></div><div class="line">/*</div><div class="line">//åˆ›å»ºæ•°æ®åº“</div><div class="line"></div><div class="line">Note.sync().<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">     Note.create(&#123;text:<span class="string">"sdsdsdsd"</span>&#125;);</div><div class="line">&#125;).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">    //æŸ¥è¯¢è¡¨</div><div class="line">    Note.findAll(&#123;raw:<span class="keyword">true</span>&#125;).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">(notes)</span></span>&#123;</div><div class="line">        console.log(notes);</div><div class="line">    &#125;)</div><div class="line">&#125;);</div><div class="line">*/</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = Note;</div></pre></td></tr></table></figure><p>ç„¶åæ˜¯åœ¨routes é‡Œå¤„ç† ajax è¯·æ±‚ï¼Œå¤„ç†ç™»å½•ä¿¡æ¯ï¼Œè·å– idï¼Œç”¨æˆ·åç­‰ç­‰ï¼Œåˆ°è¿™å°±åŸºæœ¬å®Œæˆäº†</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç»è¿‡ä¸€æ˜ŸæœŸçš„å¼€å‘ï¼Œäº†è§£äº†å‰åç«¯è”è°ƒï¼Œæ¨¡å—åŒ–å¼€å‘æ–¹å¼ã€webpack åŠloaderå’Œæ’ä»¶çš„ä½¿ç”¨ã€npm çš„ä½¿ç”¨ï¼ŒExpressçš„ä½¿ç”¨ã€è·¯ç”±ã€ä¸­é—´ä»¶ã€sqlite3ã€nodejsï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­è¿˜æ˜¯æœ‰é‡åˆ°è®¸å¤šé—®é¢˜ï¼Œä¾‹å¦‚åœ¨è¿ç»­å£°æ˜å˜é‡çš„æ—¶å€™ï¼Œä¸å°å¿ƒæŠŠé€—å·å†™æˆäº†åˆ†å·ï¼Œå…¶ä»–å˜é‡å°±å˜æˆäº†å…¨å±€å˜é‡ï¼Œäºæ˜¯å°±å‡ºé”™äº†ï¼ŒæŸ¥äº†å¥½ä¹…ğŸ˜‚<br><img src="https://ws1.sinaimg.cn/large/006tKfTcly1fji7u6i1v0j30jm06y0t6.jpg" alt=""><br>ä¸è¿‡åœ¨è¿™è¿‡ç¨‹ä¹‹ä¸­è¿˜æ˜¯å­¦åˆ°äº†è®¸å¤šï¼Œé‡è¦çš„æ˜¯è¿‡ç¨‹ï¼Œç»§ç»­å¾€å‰ç«¯çš„è·¯èµ°ä¸‹å»ğŸ˜„</p></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------æœ¬æ–‡ç»“æŸ<i class="fa fa-paw"></i>æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------</div></div></div><div><div class="my_post_copyright"><script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script><script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script><script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script><p><span>æœ¬æ–‡æ ‡é¢˜:</span><a href="/å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´.html">å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´</a></p><p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="è®¿é—® shenzekun çš„ä¸ªäººåšå®¢">shenzekun</a></p><p><span>å‘å¸ƒæ—¶é—´:</span>2017å¹´09æœˆ13æ—¥ - 20:09</p><p><span>æœ€åæ›´æ–°:</span>2017å¹´11æœˆ13æ—¥ - 07:11</p><p><span>åŸå§‹é“¾æ¥:</span><a href="/å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´.html" title="å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´">http://www.shenzekun.cn/å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´.html</a> <span class="copy-path" title="ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æ¥"><i class="fa fa-clipboard" data-clipboard-text="http://www.shenzekun.cn/å‰ç«¯å°é¡¹ç›®ä¹‹åœ¨çº¿ä¾¿åˆ©è´´.html" aria-label="å¤åˆ¶æˆåŠŸï¼"></i></span></p><p><span>è®¸å¯åè®®:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚</p></div><script>var clipboard=new Clipboard(".fa-clipboard");$(".fa-clipboard").click(function(){clipboard.on("success",function(){swal({title:"",text:"å¤åˆ¶æˆåŠŸ",icon:"success",showConfirmButton:!0})})})</script></div><div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>æ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œï¼</div><button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'><span>èµ</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/image/wechat-reward-image.png" alt="shenzekun WeChat Pay"><p>å¾®ä¿¡æ‰“èµ</p></div></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/node/" rel="tag"><i class="fa fa-tag"></i>node</a> <a href="/tags/js/" rel="tag"><i class="fa fa-tag"></i>js</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/è§£å†³inline-blockå…ƒç´ çš„bug.html" rel="next" title="è§£å†³inline-blockå…ƒç´ çš„bug"><i class="fa fa-chevron-left"></i> è§£å†³inline-blockå…ƒç´ çš„bug</a></div><div class="post-nav-prev post-nav-item"><a href="/è§£å†³-webstrom-sass-æ³¨é‡Šä¸­æ–‡å‡ºé”™é—®é¢˜.html" rel="prev" title="è§£å†³ webstrom sass æ³¨é‡Šä¸­æ–‡å‡ºé”™é—®é¢˜">è§£å†³ webstrom sass æ³¨é‡Šä¸­æ–‡å‡ºé”™é—®é¢˜ <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8yODgyMi81Mzky"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview" data-target="site-overview">ç«™ç‚¹æ¦‚è§ˆ</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person"><img class="site-author-image" itemprop="image" src="http://om8u46rmb.bkt.clouddn.com/avatar1.jpg?imageslim" alt="shenzekun"><p class="site-author-name" itemprop="name">shenzekun</p><p class="site-description motion-element" itemprop="description">Road endless its long and far, I will seek up and downï¼</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">31</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories"><span class="site-state-item-count">5</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href="/tags"><span class="site-state-item-count">17</span> <span class="site-state-item-name">æ ‡ç­¾</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/shenzekun" target="_blank" rel="external nofollow" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="http://www.jianshu.com/u/b473784d730c" target="_blank" rel="external nofollow" title="ç®€ä¹¦"><i class="fa fa-fw fa-heartbeat"></i> ç®€ä¹¦ </a></span><span class="links-of-author-item"><a href="https://twitter.com/SzkMoorez" target="_blank" rel="external nofollow" title="Twitter"><i class="fa fa-fw fa-twitter"></i> Twitter </a></span><span class="links-of-author-item"><a href="https://segmentfault.com/u/juli_590dd17068b9e" target="_blank" rel="external nofollow" title="SegmentFault"><i class="fa fa-fw fa-meh-o"></i> SegmentFault </a></span><span class="links-of-author-item"><a href="http://blog.csdn.net/qq_33699981?viewmode=list" target="_blank" rel="external nofollow" title="csdn"><i class="fa fa-fw fa-crosshairs"></i> csdn </a></span><span class="links-of-author-item"><a href="https://juejin.im/user/5866ed77ac502e00612f1949" target="_blank" rel="external nofollow" title="æ˜é‡‘"><i class="fa fa-fw fa-spinner"></i> æ˜é‡‘</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-globe"></i> æ¨èé˜…è¯»</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="http://www.uisdc.com/" title="ä¼˜è®¾" target="_blank">ä¼˜è®¾</a></li><li class="links-of-blogroll-item"><a href="http://www.zhangxinxu.com/" title="å¼ é‘«æ—­" target="_blank">å¼ é‘«æ—­</a></li><li class="links-of-blogroll-item"><a href="http://www.alloyteam.com/nav/" title="Webå‰ç«¯å¯¼èˆª" target="_blank">Webå‰ç«¯å¯¼èˆª</a></li><li class="links-of-blogroll-item"><a href="http://www.36zhen.com/t?id=3448" title="å‰ç«¯ä¹¦ç±èµ„æ–™" target="_blank">å‰ç«¯ä¹¦ç±èµ„æ–™</a></li><li class="links-of-blogroll-item"><a href="http://ife.baidu.com/" title="ç™¾åº¦å‰ç«¯æŠ€æœ¯å­¦é™¢" target="_blank">ç™¾åº¦å‰ç«¯æŠ€æœ¯å­¦é™¢</a></li><li class="links-of-blogroll-item"><a href="http://wf.uisdc.com/cn/" title="googleå‰ç«¯å¼€å‘åŸºç¡€" target="_blank">googleå‰ç«¯å¼€å‘åŸºç¡€</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š"><span class="nav-number">1.</span> <span class="nav-text">å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é¢„è§ˆ"><span class="nav-number">2.</span> <span class="nav-text">é¢„è§ˆ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¶‰åŠçš„çŸ¥è¯†ç‚¹"><span class="nav-number">3.</span> <span class="nav-text">æ¶‰åŠçš„çŸ¥è¯†ç‚¹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®ç°åŠŸèƒ½"><span class="nav-number">4.</span> <span class="nav-text">å®ç°åŠŸèƒ½</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‡†å¤‡å·¥ä½œ"><span class="nav-number">5.</span> <span class="nav-text">å‡†å¤‡å·¥ä½œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é¡¹ç›®æ€è·¯"><span class="nav-number">6.</span> <span class="nav-text">é¡¹ç›®æ€è·¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®ç°"><span class="nav-number">7.</span> <span class="nav-text">å®ç°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ€»ç»“"><span class="nav-number">8.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">shenzekun</span></div><div class="powered-by"><i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv"> è®¿é—®ç”¨æˆ·ï¼š<span id="busuanzi_value_site_uv"></span></span></div><div class="powered-by"><i class="fa fa-eye"></i> <span id="busuanzi_container_site_pv">è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span></span></div><div class="theme-info"><i class="fa fa-pencil"></i> <span class="post-count">åšå®¢å…¨ç«™å…± 30.5k å­—</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script><script type="text/javascript">!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&((n=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="popoverlay">').css("overflow","hidden"),$(".popup").toggle()}var isfetched=!1,search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path,searchFunc=function(e,t,a){"use strict";$.ajax({url:e,dataType:"xml",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var r=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),c=document.getElementById(t),n=document.getElementById(a);c.addEventListener("input",function(){var e=0,t='<ul class="search-result-list">',a=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length>1&&r.forEach(function(r){var c=!1,n=r.title.trim().toLowerCase(),s=r.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),o=decodeURIComponent(r.url),i=-1,l=-1,p=-1;if(""!=n&&a.forEach(function(e,t){i=n.indexOf(e),l=s.indexOf(e),(i>=0||l>=0)&&(c=!0,0==t&&(p=l))}),c){e+=1,t+="<li><a href='"+o+"' class='search-result-title'>"+n+"</a>";var h=r.content.trim().replace(/<[^>]+>/g,"");if(p>=0){var u=p-20,d=p+80;u<0&&(u=0),0==u&&(d=50),d>h.length&&(d=h.length);var f=h.substring(u,d);a.forEach(function(e){var t=new RegExp(e,"gi");f=f.replace(t,'<b class="search-keyword">'+e+"</b>")}),t+='<p class="search-result">'+f+"...</p>"}t+="</li>"}}),t+="</ul>",0==e&&(t='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'),""==a&&(t='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'),n.innerHTML=t}),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),0==isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(function(e){$(".popup").hide(),$(".popoverlay").remove(),$("body").css("overflow","")}),$(".popup").click(function(e){e.stopPropagation()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("Cc9hxvKgB63w6aMIIBCV2Bfz-gzGzoHsz","mBmolCuukl1GN11A7m8VQj9f")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){if(0!==e.length){for(c=0;c<e.length;c++){var t=e[c],i=t.get("url"),s=t.get("time"),l=document.getElementById(i);$(l).find(".leancloud-visitors-count").text(s)}for(var c=0;c<n.length;c++){var i=n[c],l=document.getElementById(i),r=$(l).find(".leancloud-visitors-count");""==r.text()&&r.text(0)}}else o.find(".leancloud-visitors-count").text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){$(document.getElementById(n)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var s=new e,l=new AV.ACL;l.setPublicReadAccess(!0),l.setPublicWriteAccess(!0),s.setACL(l),s.set("title",o),s.set("url",n),s.set("time",1),s.save(null,{success:function(e){$(document.getElementById(n)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script></body></html>